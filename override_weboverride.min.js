"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var _$StartupHandler$_=function(){function _$StartupHandler$_(){var search_name=arguments.length<=0||arguments[0]===undefined?[]:arguments[0];var instances=arguments.length<=1||arguments[1]===undefined?[]:arguments[1];_classCallCheck(this,_$StartupHandler$_);this.ensureStringArray(search_name);this.ensureStringArray(instances);this.libraries=instances;this.installLibraries(search_name);this.startup_delay=400;this.triggerPending();this.script_src=document.getElementsByTagName("head")[0].appendChild(document.createElement("script"))}_createClass(_$StartupHandler$_,[{key:"triggerPending",value:function triggerPending(){setTimeout(this.pending.bind(this),this.startup_delay)}},{key:"pending",value:function pending(){if(!this.testLibrariesLoaded()){this.triggerPending();return}console.info("------------------STARTUP-----------------------------------");console.info("added JSLib:",this.libraries);this._onLibrariesInitialized()}},{key:"ensureStringArray",value:function ensureStringArray(array){array.forEach(function(el){if(typeof el!="string")new Error("invalid libraries assignment")})}},{key:"testLibrariesLoaded",value:function testLibrariesLoaded(){var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=this.libraries[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var l=_step.value;if(eval(l)==undefined)return false}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}return true}},{key:"onLibraryLoaded",value:function onLibraryLoaded(fn){new Error("Not Implemented yet");this.onLibraryLoaded=fn.bind(this)}},{key:"_onLibraryLoaded",value:function _onLibraryLoaded(){new Error("Not Implemented yet");this.onLibraryLoaded()}},{key:"onLibrariesInitialized",value:function onLibrariesInitialized(fn){this.onLibrariesInitialized=fn.bind(this)}},{key:"_onLibrariesInitialized",value:function _onLibrariesInitialized(){function someAction(){var scripts=document.getElementsByTagName("head")[0].getElementsByTagName("script");var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=scripts[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var l=_step2.value;l.setAttribute("addedBy","server")}}catch(err){_didIteratorError2=true;_iteratorError2=err}finally{try{if(!_iteratorNormalCompletion2&&_iterator2.return){_iterator2.return()}}finally{if(_didIteratorError2){throw _iteratorError2}}}}someAction();this.onLibrariesInitialized()}},{key:"installLibraries",value:function installLibraries(libs){var xhttp=new XMLHttpRequest,cdnjs="https://api.cdnjs.com/libraries?search="+lib.name,script=this.script_src;xhttp.onreadystatechange=function(){if(xhttp.readyState==XMLHttpRequest.DONE){if(xhttp.status==200){var json=JSON.parse(xhttp.responseText).results.slice(0,20);script.setAttribute("src",json[0].latest)}else if(xhttp.status==400){alert("There was an error 400")}else{alert("something else other than 200 was returned")}}};var _iteratorNormalCompletion3=true;var _didIteratorError3=false;var _iteratorError3=undefined;try{for(var _iterator3=libs[Symbol.iterator](),_step3;!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=true){var _lib=_step3.value;_lib={name:_lib};console.log("js:",cdnjs);xhttp.open("GET",cdnjs,true);xhttp.send()}}catch(err){_didIteratorError3=true;_iteratorError3=err}finally{try{if(!_iteratorNormalCompletion3&&_iterator3.return){_iterator3.return()}}finally{if(_didIteratorError3){throw _iteratorError3}}}}}]);return _$StartupHandler$_}();